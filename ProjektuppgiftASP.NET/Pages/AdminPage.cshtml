@page
@using Microsoft.AspNetCore.Identity
@using ProjektuppgiftASP.NET.Models;
@inject SignInManager<MyUser> SignInManager
@inject UserManager<MyUser> UserManager

@model ProjektuppgiftASP.NET.Pages.AdminPageModel

@inject UserManager<MyUser> userManager
@{
}

<h1>Admin Page</h1>

@if (User.IsInRole("Admin"))
{
    <h1 class="display-4">Hej Admin!</h1>

    @foreach (var user in Model.Users)
    {
        Model.CheckBox = await userManager.IsInRoleAsync(user, "Organizer");

        <form method="post" asp-route-id="@user.Id">
            @Html.CheckBoxFor(m => m.CheckBox, new { onchange = "this.form.submit()" })
        </form>

        <p>@user.UserName - @user.Email</p>}
}

else
{
    <a asp-area="Identity" asp-page="/Account/Login">
        <input type="button" class="btn btn-primary" value="Log In">
    </a>
}